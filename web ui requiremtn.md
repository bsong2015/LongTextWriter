# **长文档写作软件界面设计文档**

## **1. 核心设计理念**

本界面设计旨在为用户提供一个清晰、高效、结构化的写作环境。核心理念如下：

*   **类型驱动的界面 (Type-Driven UI):** 软件的核心工作流程将根据用户创建的项目类型（**图书 Book**, **系列文章 Series**, **模板化文档 Templated**）动态调整，为不同写作目标提供最优的操作路径。
*   **分步式工作流 (Step-by-Step Workflow):** 将复杂的写作过程分解为独立且连续的步骤（如：`设定` -> `大纲` -> `内容` -> `发布`），引导用户有序地完成创作。
*   **结构化编辑与状态可视化 (Structured Editing & Status Visualization):** 界面元素与后端数据结构（Zod Schema）严格对应，并清晰地展示内容生成过程中的各种状态，提供确定性和掌控感。

## **2. 主界面：项目管理仪表盘 (Project Dashboard)**

用户进入应用后的首个页面，用于集中管理所有写作项目。

### **2.1. 界面布局**

*   **顶部导航栏:**
    *   **Logo/应用名称:** 位于左侧。
    *   **语言切换器:** 下拉菜单，用于切换界面语言。
*   **主内容区:**
    *   **“+ 新建项目” 按钮:** 页面中最醒目的操作按钮。
    *   **项目列表:**
        *   以卡片网格或列表形式展示所有项目。
        *   **项目卡片:**
            *   **项目名称 (`name`)**
            *   **项目类型标签:** 用醒目的标签或图标标识项目类型 (e.g., 📖 图书, 📚 系列, 📄 模板)。
            *   **创建日期 (`createdAt`)**
            *   **操作按钮:** 删除图标（需二次确认）。
        *   点击项目卡片将导航至该项目的详情页。

### **2.2. “新建项目” 模态框**

这是一个分步式弹窗，用于引导用户创建不同类型的项目。

*   **第一步：选择项目类型 (`type`)**
    *   提供三个视觉上清晰区分的选项卡或大按钮：
        *   **图书 (Book):** 用于创作结构化、章节分明的书籍。
        *   **系列文章 (Series):** 用于撰写主题相关联的多篇文章。
        *   **模板化文档 (Templated):** 用于基于已有模板和源文件快速生成文档。

*   **第二步：填写项目信息 (表单内容根据第一步的选择动态变化)**

    *   **若选择 "图书" 或 "系列文章":**
        *   **项目名称 (`name`):** `[文本输入框]` - 必填。
        *   **写作语言 (`idea.language`):** `[下拉选择框]` - 如：中文, English。
        *   **核心思想/摘要 (`idea.summary`):** `[多行文本域]` - 描述文档的核心内容。
        *   **全局要求/Prompt (`idea.prompt`):** `[多行文本域]` - 输入对AI写作的全局指令（如风格、语气、关键要素等）。

    *   **若选择 "模板化文档":**
        *   **项目名称 (`name`):** `[文本输入框]` - 必填。
        *   **源文件 (`sources`):** `[文件上传控件]` - 支持选择并上传**多个**源文件。
        *   **模板文件 (`template`):** `[文件上传控件]` - 支持选择**单个**模板文件。

*   **操作按钮:**
    *   **创建项目:** 提交表单，调用 `POST /api/projects`。
    *   **取消:** 关闭模态框。

---

## **3. 核心界面：项目详情页 (Project Detail Page)**

写作和编辑的主要工作区。此页面的布局和功能将根据项目类型进行适配。

### **A. 针对 "图书 (Book)" 和 "系列文章 (Series)" 项目**

此类项目遵循一个创造性的线性工作流。

#### **3.1. 整体布局**

*   **页面头部:**
    *   **返回项目列表** 链接/按钮。
    *   **项目名称** 作为页面大标题。
*   **导航标签页 (Tabs):**
    *   **1. 设定 (Settings):** 定义写作的核心要素。
    *   **2. 大纲 (Outline):** 设计文档的骨架结构。
    *   **3. 内容 (Content):** 生成并精修具体内容。
    *   **4. 发布 (Publish):** 导出最终成品。

#### **3.2. 各标签页详解**

*   **1. 设定 (Settings) 标签页**
    *   **用途:** 修改项目的核心 `idea` 对象。
    *   **界面:** 一个简单的表单，包含以下可编辑字段：
        *   写作语言 (`idea.language`)
        *   核心思想/摘要 (`idea.summary`)
        *   全局要求/Prompt (`idea.prompt`)
    *   **操作:** “保存设定” 按钮。

*   **2. 大纲 (Outline) 标签页**
    *   **用途:** 创建和编辑符合 `BookOutlineSchema` 的三级文档结构。
    *   **界面:**
        *   **总标题 (`outline.title`):** 位于顶部的可编辑输入框。
        *   **大纲编辑区:** 一个可交互的树状列表。
            *   **第一级 (章节 `chapters`):** 用户可添加、删除、重命名和拖拽排序。
            *   **第二级 (文章 `articles`):** 嵌套在章节下，用户可添加、删除、重命名和拖拽排序。
    *   **操作:**
        *   **“智能生成大纲”** 按钮（会提示覆盖已有内容）。
        *   **“保存大纲”** 按钮。

*   **3. 内容 (Content) 标签页**
    *   **用途:** 基于大纲生成内容，并对每一篇文章进行精细化编辑。
    *   **界面 (双栏布局):**
        *   **左侧：大纲导航栏**
            *   以**只读**的树状列表显示已保存的大纲结构（章节和文章）。
            *   每篇**文章 (`article`)** 标题旁都有一个**状态指示器 (`status`)**:
                *   ⚪ **待处理 (pending)**
                *   ✍️ **生成中 (writing)**
                *   ✅ **已完成 (done)**
                *   ❌ **出错 (error)**
            *   点击文章标题，会在右侧加载其详细内容进行编辑。
        *   **右侧：文章编辑区**
            *   **文章标题 (`title`):** 可编辑的文本框。
            *   **文章摘要 (`summary`):** 可编辑的多行文本域。
            *   **正文 (`content`):** 一个功能完善的**富文本编辑器**。
    *   **操作:**
        *   **“生成全部内容”** 按钮（位于顶部工具栏）。
        *   **“保存当前文章”** 按钮。
        *   (可选) 在左侧导航栏的每篇文章旁放置一个小的“生成”图标，用于单独生成。

*   **4. 发布 (Publish) 标签页**
    *   **用途:** 将最终内容导出为文件。
    *   **界面:**
        *   **导出格式 (`publishType`):** `[下拉选择框]` 或 `[单选按钮组]` (e.g., PDF, Markdown, Word)。
        *   **“发布并生成下载文件”** 按钮。
        *   **下载区域:** 发布成功后，此处会动态生成一个**“点击下载”**的链接。

---

### **B. 针对 "模板化文档 (Templated)" 项目**

此类项目的工作流更为直接和工具化。

#### **3.1. 整体布局**

*   **页面头部:**
    *   **返回项目列表** 链接/按钮。
    *   **项目名称** 作为页面大标题。
*   **导航标签页 (Tabs):**
    *   **1. 文件配置 (Files):** 管理输入文件。
    *   **2. 生成 (Generate):** 执行生成并预览。
    *   **3. 发布 (Publish):** 导出最终成品。

#### **3.2. 各标签页详解**

*   **1. 文件配置 (Files) 标签页**
    *   **用途:** 管理项目的 `sources` 和 `template` 文件。
    *   **界面:**
        *   **源文件列表:** 显示已上传的源文件列表，支持移除和添加新文件。
        *   **模板文件区域:** 显示已上传的模板文件，支持替换。
    *   **操作:** “保存更改” 按钮。

*   **2. 生成 (Generate) 标签页**
    *   **用途:** 触发文档生成过程并预览结果。
    *   **界面:**
        *   **“开始生成”** 按钮。
        *   **预览窗口:** 一个只读区域，用于显示生成后的文档内容（可以是纯文本或渲染后的HTML）。

*   **3. 发布 (Publish) 标签页**
    *   **用途与功能:** 与 "图书/系列文章" 项目的发布页完全相同。